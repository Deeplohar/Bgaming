<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Coin Management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="global.css"> 
    <link rel="stylesheet" href="payment.css"> 
    <style>
        /* Payment ‡§™‡•á‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•á‡§Ç‡§ü‡•ç‡§∞‡§≤ ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§° */
        .box { 
            max-width: 400px; 
            padding: 0; 
            height: fit-content;
            max-height: 95vh;
        }
        /* Utility for hiding elements */
        .hidden { display: none !important; }
        
        /* üî• FIX FOR HEADER LAYOUT */
        .header-fixed {
            padding: 30px 30px 15px 30px;
        }
        .header-fixed > div:first-child {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; /* üî• ‡§Ø‡•á ‡§¨‡§¶‡§≤‡§æ‡§µ */
            margin-bottom: 15px;
            flex-wrap: nowrap;
        }
        .header-fixed h2 {
            margin: 0;
            line-height: 1;
        }
        .back-btn {
            margin-top: 0;
            align-self: flex-start; /* üî• ‡§Ø‡•á ‡§¨‡§¶‡§≤‡§æ‡§µ */
        }
    </style>
</head>

<body>
    <div class="main-content">
        <div class="box">
            <!-- üî• UPDATED HEADER LAYOUT -->
            <div class="header-fixed">
                <div>
                    <h2>Wallet</h2>
                    <button class="back-btn" onclick="window.location.href='welcome.html'">‚Üê Back to Game</button>
                </div>
                <p id="userEmail">Loading...</p>
                <h3>Fund: <span id="userCoins">Loading...</span></h3>
                <hr>
            </div>
            
            <div class="content-scroll" style="padding: 0 20px 10px 20px;">
                <!-- Rest of your content remains the same -->
                <p id="errorMsg" class="error-msg"></p>

                <div class="section-card" id="depositSectionCard" style="margin-top: 10px;">
                    <div id="depositInputGroup">
                        <h3 class="card-title">Deposit Coins</h3>
                        <div class="payment-input-group">
                            <input type="number" id="depositInput" class="payment-input" min="1" placeholder="Amount to Deposit (fund)">
                            <button class="deposit-btn" id="initDepositBtn">Deposit</button>
                        </div>
                    </div>

                    <div class="payment-options-box hidden" id="paymentOptionsBox">
                        <h4>Payment Details:</h4>
                        <p style="font-size: 1.5em; font-weight: bold;">Amount: ‚Çπ<span id="paymentAmountDisplay">0</span></p>

                        <p style="font-size: 14px; margin-top: 5px;">Step 1: Make payment to Merchant UPI ID from any of the below mentioned apps‡•§</p>
                        <div class="payment-apps">
                            <a href="#" id="phonepeLink" class="payment-app-btn" target="_blank">üì± Pay with PhonePe</a>
                            <a href="#" id="googlepayLink" class="payment-app-btn" target="_blank">üí≥ Pay with Google Pay</a>
                            <a href="#" id="paytmLink" class="payment-app-btn" target="_blank">üîµ Pay with Paytm</a>
                            <a href="#" id="otherUpiLink" class="payment-app-btn" target="_blank">üåê Other UPI App Link</a> 
                        </div>

                        <hr>

                        <p style="font-size: 14px; margin-bottom: 5px;">Step 2: After making the payment, enter your UPI ID and UTR/Transaction ID‡•§</p>
                        
                        <div class="payment-input-group">
                            <input type="text" id="userUpiIdInput" class="payment-input" placeholder="(your upi id)">
                        </div>
                        <div class="payment-input-group">
                            <input type="text" id="userUtrInput" class="payment-input" placeholder="UTR / Transaction ID (6+ Digits)">
                        </div>

                        <p style="font-size: 12px; color: #d32f2f;">
                            üö´ Warning: Submitting a request without making payment may result in your account being blocked. **Be sure to press the "Submit Request" button to confirm the deposit request.**
                        </p>

                        <button class="deposit-btn" id="submitDepositFinalBtn" style="margin-top: 8px;">‚úÖ Submit Deposit Request</button>

                        <button class="withdraw-btn cancel-btn" id="cancelPaymentBtn" style="margin-top: 10px;">Cancel & Change Amount</button>

                    </div>
                </div>
                <hr style="margin: 10px 0;">

                <div class="section-card" id="withdrawalSectionCard">
                    <h3 class="card-title">Withdraw Coins</h3>
                    <div id="withdrawalInputGroup"> 
                        <div class="payment-input-group">
                            <input type="text" id="withdrawalUpiIdInput" class="payment-input" placeholder="please enter your (upi id )">
                        </div>
                        <div class="payment-input-group">
                            <input type="number" id="withdrawInput" class="payment-input" min="1" placeholder="Amount to Withdraw (fund)">
                            <button class="withdraw-btn" id="withdrawBtn">Cash Out</button>
                        </div>
                    </div>
                </div>
                <hr id="requestSeparator" class="hidden" style="margin-top: 10px; margin-bottom: 10px;"> 

                <div id="pendingRequestsContainer" class="section-card hidden">
                    <h3 class="card-title">‚è≥ Your Pending Requests</h3>
                    
                    <div class="requests-scroll-wrapper">
                        <ul id="pendingRequestsList" class="request-list">
                            </ul>
                    </div>
                    
                    <p class="status-tip">Please wait. This list will be updated when approved/rejected by the admin.‡•§</p>
                </div>
                <button class="play" style="margin-top: 10px; margin-bottom: 0;" onclick="window.location.href='welcome.html'">Go Back to Game</button>
            </div>
        </div>
    </div>
    <script type="module" src="firebase.js"></script>
    <script type="module" src="payment-logic.js"></script>
</body>
</html>